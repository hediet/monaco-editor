var __decorate=this&&this.__decorate||function(e,i,t,o){var n,r=arguments.length,c=r<3?i:null===o?o=Object.getOwnPropertyDescriptor(i,t):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,i,t,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(c=(r<3?n(c):r>3?n(i,t,c):n(i,t))||c);return r>3&&c&&Object.defineProperty(i,t,c),c},__param=this&&this.__param||function(e,i){return function(t,o){i(t,o,e)}};import{addDisposableListener}from"../../../base/browser/dom.js";import{Emitter}from"../../../base/common/event.js";import{Disposable}from"../../../base/common/lifecycle.js";import{CONTEXT_ACCESSIBILITY_MODE_ENABLED}from"../common/accessibility.js";import{IConfigurationService}from"../../configuration/common/configuration.js";import{IContextKeyService}from"../../contextkey/common/contextkey.js";import{ILayoutService}from"../../layout/browser/layoutService.js";let AccessibilityService=class extends Disposable{constructor(e,i,t){super(),this._contextKeyService=e,this._layoutService=i,this._configurationService=t,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new Emitter,this._onDidChangeReducedMotion=new Emitter,this._accessibilityModeEnabledContext=CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);const o=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration((e=>{e.affectsConfiguration("editor.accessibilitySupport")&&(o(),this._onDidChangeScreenReaderOptimized.fire()),e.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())}))),o(),this._register(this.onDidChangeScreenReaderOptimized((()=>o())));const n=window.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=n.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this.initReducedMotionListeners(n)}initReducedMotionListeners(e){if(!this._layoutService.hasContainer)return;this._register(addDisposableListener(e,"change",(()=>{this._systemMotionReduced=e.matches,"auto"===this._configMotionReduced&&this._onDidChangeReducedMotion.fire()})));const i=()=>{const e=this.isMotionReduced();this._layoutService.container.classList.toggle("reduce-motion",e),this._layoutService.container.classList.toggle("enable-motion",!e)};i(),this._register(this.onDidChangeReducedMotion((()=>i())))}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return"on"===e||"auto"===e&&2===this._accessibilitySupport}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return"on"===e||"auto"===e&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};AccessibilityService=__decorate([__param(0,IContextKeyService),__param(1,ILayoutService),__param(2,IConfigurationService)],AccessibilityService);export{AccessibilityService};