var __decorate=this&&this.__decorate||function(e,t,n,i){var o,r=arguments.length,c=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(c=(r<3?o(c):r>3?o(t,n,c):o(t,n))||c);return r>3&&c&&Object.defineProperty(t,n,c),c},__param=this&&this.__param||function(e,t){return function(n,i){t(n,i,e)}};import{ModifierKeyEmitter}from"../../../base/browser/dom.js";import{Separator}from"../../../base/common/actions.js";import{Emitter}from"../../../base/common/event.js";import{Disposable}from"../../../base/common/lifecycle.js";import{createAndFillInContextMenuActions}from"../../actions/browser/menuEntryActionViewItem.js";import{IMenuService,MenuId}from"../../actions/common/actions.js";import{IContextKeyService}from"../../contextkey/common/contextkey.js";import{IKeybindingService}from"../../keybinding/common/keybinding.js";import{INotificationService}from"../../notification/common/notification.js";import{ITelemetryService}from"../../telemetry/common/telemetry.js";import{ContextMenuHandler}from"./contextMenuHandler.js";import{IContextViewService}from"./contextView.js";let ContextMenuService=class extends Disposable{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new ContextMenuHandler(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,n,i,o,r){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=n,this.keybindingService=i,this.menuService=o,this.contextKeyService=r,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new Emitter),this._onDidHideContextMenu=this._store.add(new Emitter)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=ContextMenuMenuDelegate.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu(Object.assign(Object.assign({},e),{onHide:t=>{var n;null===(n=e.onHide)||void 0===n||n.call(e,t),this._onDidHideContextMenu.fire()}})),ModifierKeyEmitter.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};ContextMenuService=__decorate([__param(0,ITelemetryService),__param(1,INotificationService),__param(2,IContextViewService),__param(3,IKeybindingService),__param(4,IMenuService),__param(5,IContextKeyService)],ContextMenuService);export{ContextMenuService};export var ContextMenuMenuDelegate;!function(e){e.transform=function(e,t,n){if(!((i=e)&&i.menuId instanceof MenuId))return e;var i;const{menuId:o,menuActionOptions:r,contextKeyService:c}=e;return Object.assign(Object.assign({},e),{getActions:()=>{const i=[];if(o){const e=t.createMenu(o,null!=c?c:n);createAndFillInContextMenuActions(e,r,i),e.dispose()}return e.getActions?Separator.join(e.getActions(),i):i}})}}(ContextMenuMenuDelegate||(ContextMenuMenuDelegate={}));