import*as dom from"../../dom.js";import{renderLabelWithIcons}from"../iconLabel/iconLabels.js";import*as objects from"../../../common/objects.js";export class HighlightedLabel{constructor(t,s){var e;this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=null!==(e=null==s?void 0:s.supportIcons)&&void 0!==e&&e,this.domNode=dom.append(t,dom.$("span.monaco-highlighted-label"))}get element(){return this.domNode}set(t,s=[],e="",i){t||(t=""),i&&(t=HighlightedLabel.escapeNewLines(t,s)),this.didEverRender&&this.text===t&&this.title===e&&objects.equals(this.highlights,s)||(this.text=t,this.title=e,this.highlights=s,this.render())}render(){const t=[];let s=0;for(const e of this.highlights){if(e.end===e.start)continue;if(s<e.start){const i=this.text.substring(s,e.start);this.supportIcons?t.push(...renderLabelWithIcons(i)):t.push(i),s=e.start}const i=this.text.substring(s,e.end),o=dom.$("span.highlight",void 0,...this.supportIcons?renderLabelWithIcons(i):[i]);e.extraClasses&&o.classList.add(...e.extraClasses),t.push(o),s=e.end}if(s<this.text.length){const e=this.text.substring(s);this.supportIcons?t.push(...renderLabelWithIcons(e)):t.push(e)}dom.reset(this.domNode,...t),this.title?this.domNode.title=this.title:this.domNode.removeAttribute("title"),this.didEverRender=!0}static escapeNewLines(t,s){let e=0,i=0;return t.replace(/\r\n|\r|\n/g,((t,o)=>{i="\r\n"===t?-1:0,o+=e;for(const t of s)t.end<=o||(t.start>=o&&(t.start+=i),t.end>=o&&(t.end+=i));return e+=i,"‚èé"}))}}