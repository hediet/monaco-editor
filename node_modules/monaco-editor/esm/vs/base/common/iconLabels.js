import{matchesFuzzy}from"./filters.js";import{ltrim}from"./strings.js";import{ThemeIcon}from"./themables.js";const iconStartMarker="$(",iconsRegex=new RegExp(`\\$\\(${ThemeIcon.iconNameExpression}(?:${ThemeIcon.iconModifierExpression})?\\)`,"g"),escapeIconsRegex=new RegExp(`(\\\\)?${iconsRegex.source}`,"g");export function escapeIcons(e){return e.replace(escapeIconsRegex,((e,n)=>n?e:`\\${e}`))}const markdownEscapedIconsRegex=new RegExp(`\\\\${iconsRegex.source}`,"g");export function markdownEscapeEscapedIcons(e){return e.replace(markdownEscapedIconsRegex,(e=>`\\${e}`))}const stripIconsRegex=new RegExp(`(\\s)?(\\\\)?${iconsRegex.source}(\\s)?`,"g");export function stripIcons(e){return-1===e.indexOf("$(")?e:e.replace(stripIconsRegex,((e,n,s,o)=>s?e:n||o||""))}export function getCodiconAriaLabel(e){return e?e.replace(/\$\((.*?)\)/g,((e,n)=>` ${n} `)).trim():""}const _parseIconsRegex=new RegExp(`\\$\\(${ThemeIcon.iconNameCharacter}+\\)`,"g");export function parseLabelWithIcons(e){_parseIconsRegex.lastIndex=0;let n="";const s=[];let o=0;for(;;){const t=_parseIconsRegex.lastIndex,c=_parseIconsRegex.exec(e),r=e.substring(t,null==c?void 0:c.index);if(r.length>0){n+=r;for(let e=0;e<r.length;e++)s.push(o)}if(!c)break;o+=c[0].length}return{text:n,iconOffsets:s}}export function matchesFuzzyIconAware(e,n,s=!1){const{text:o,iconOffsets:t}=n;if(!t||0===t.length)return matchesFuzzy(e,o,s);const c=ltrim(o," "),r=o.length-c.length,i=matchesFuzzy(e,c,s);if(i)for(const e of i){const n=t[e.start+r]+r;e.start+=n,e.end+=n}return i}