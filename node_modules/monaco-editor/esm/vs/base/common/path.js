import*as process from"./process.js";const CHAR_UPPERCASE_A=65,CHAR_LOWERCASE_A=97,CHAR_UPPERCASE_Z=90,CHAR_LOWERCASE_Z=122,CHAR_DOT=46,CHAR_FORWARD_SLASH=47,CHAR_BACKWARD_SLASH=92,CHAR_COLON=58,CHAR_QUESTION_MARK=63;class ErrorInvalidArgType extends Error{constructor(e,t,r){let o;"string"==typeof t&&0===t.indexOf("not ")?(o="must not be",t=t.replace(/^not /,"")):o="must be";const i=-1!==e.indexOf(".")?"property":"argument";let a=`The "${e}" ${i} ${o} of type ${t}`;a+=". Received type "+typeof r,super(a),this.code="ERR_INVALID_ARG_TYPE"}}function validateObject(e,t){if(null===e||"object"!=typeof e)throw new ErrorInvalidArgType(t,"Object",e)}function validateString(e,t){if("string"!=typeof e)throw new ErrorInvalidArgType(t,"string",e)}const platformIsWin32="win32"===process.platform;function isPathSeparator(e){return 47===e||92===e}function isPosixPathSeparator(e){return 47===e}function isWindowsDeviceRoot(e){return e>=65&&e<=90||e>=97&&e<=122}function normalizeString(e,t,r,o){let i="",a=0,n=-1,s=0,l=0;for(let h=0;h<=e.length;++h){if(h<e.length)l=e.charCodeAt(h);else{if(o(l))break;l=47}if(o(l)){if(n===h-1||1===s);else if(2===s){if(i.length<2||2!==a||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2)){if(i.length>2){const e=i.lastIndexOf(r);-1===e?(i="",a=0):(i=i.slice(0,e),a=i.length-1-i.lastIndexOf(r)),n=h,s=0;continue}if(0!==i.length){i="",a=0,n=h,s=0;continue}}t&&(i+=i.length>0?`${r}..`:"..",a=2)}else i.length>0?i+=`${r}${e.slice(n+1,h)}`:i=e.slice(n+1,h),a=h-n-1;n=h,s=0}else 46===l&&-1!==s?++s:s=-1}return i}function _format(e,t){validateObject(t,"pathObject");const r=t.dir||t.root,o=t.base||`${t.name||""}${t.ext||""}`;return r?r===t.root?`${r}${o}`:`${r}${e}${o}`:o}export const win32={resolve(...e){let t="",r="",o=!1;for(let i=e.length-1;i>=-1;i--){let a;if(i>=0){if(a=e[i],validateString(a,"path"),0===a.length)continue}else 0===t.length?a=process.cwd():(a=process.env[`=${t}`]||process.cwd(),(void 0===a||a.slice(0,2).toLowerCase()!==t.toLowerCase()&&92===a.charCodeAt(2))&&(a=`${t}\\`));const n=a.length;let s=0,l="",h=!1;const c=a.charCodeAt(0);if(1===n)isPathSeparator(c)&&(s=1,h=!0);else if(isPathSeparator(c))if(h=!0,isPathSeparator(a.charCodeAt(1))){let e=2,t=e;for(;e<n&&!isPathSeparator(a.charCodeAt(e));)e++;if(e<n&&e!==t){const r=a.slice(t,e);for(t=e;e<n&&isPathSeparator(a.charCodeAt(e));)e++;if(e<n&&e!==t){for(t=e;e<n&&!isPathSeparator(a.charCodeAt(e));)e++;e!==n&&e===t||(l=`\\\\${r}\\${a.slice(t,e)}`,s=e)}}}else s=1;else isWindowsDeviceRoot(c)&&58===a.charCodeAt(1)&&(l=a.slice(0,2),s=2,n>2&&isPathSeparator(a.charCodeAt(2))&&(h=!0,s=3));if(l.length>0)if(t.length>0){if(l.toLowerCase()!==t.toLowerCase())continue}else t=l;if(o){if(t.length>0)break}else if(r=`${a.slice(s)}\\${r}`,o=h,h&&t.length>0)break}return r=normalizeString(r,!o,"\\",isPathSeparator),o?`${t}\\${r}`:`${t}${r}`||"."},normalize(e){validateString(e,"path");const t=e.length;if(0===t)return".";let r,o=0,i=!1;const a=e.charCodeAt(0);if(1===t)return isPosixPathSeparator(a)?"\\":e;if(isPathSeparator(a))if(i=!0,isPathSeparator(e.charCodeAt(1))){let i=2,a=i;for(;i<t&&!isPathSeparator(e.charCodeAt(i));)i++;if(i<t&&i!==a){const n=e.slice(a,i);for(a=i;i<t&&isPathSeparator(e.charCodeAt(i));)i++;if(i<t&&i!==a){for(a=i;i<t&&!isPathSeparator(e.charCodeAt(i));)i++;if(i===t)return`\\\\${n}\\${e.slice(a)}\\`;i!==a&&(r=`\\\\${n}\\${e.slice(a,i)}`,o=i)}}}else o=1;else isWindowsDeviceRoot(a)&&58===e.charCodeAt(1)&&(r=e.slice(0,2),o=2,t>2&&isPathSeparator(e.charCodeAt(2))&&(i=!0,o=3));let n=o<t?normalizeString(e.slice(o),!i,"\\",isPathSeparator):"";return 0!==n.length||i||(n="."),n.length>0&&isPathSeparator(e.charCodeAt(t-1))&&(n+="\\"),void 0===r?i?`\\${n}`:n:i?`${r}\\${n}`:`${r}${n}`},isAbsolute(e){validateString(e,"path");const t=e.length;if(0===t)return!1;const r=e.charCodeAt(0);return isPathSeparator(r)||t>2&&isWindowsDeviceRoot(r)&&58===e.charCodeAt(1)&&isPathSeparator(e.charCodeAt(2))},join(...e){if(0===e.length)return".";let t,r;for(let o=0;o<e.length;++o){const i=e[o];validateString(i,"path"),i.length>0&&(void 0===t?t=r=i:t+=`\\${i}`)}if(void 0===t)return".";let o=!0,i=0;if("string"==typeof r&&isPathSeparator(r.charCodeAt(0))){++i;const e=r.length;e>1&&isPathSeparator(r.charCodeAt(1))&&(++i,e>2&&(isPathSeparator(r.charCodeAt(2))?++i:o=!1))}if(o){for(;i<t.length&&isPathSeparator(t.charCodeAt(i));)i++;i>=2&&(t=`\\${t.slice(i)}`)}return win32.normalize(t)},relative(e,t){if(validateString(e,"from"),validateString(t,"to"),e===t)return"";const r=win32.resolve(e),o=win32.resolve(t);if(r===o)return"";if((e=r.toLowerCase())===(t=o.toLowerCase()))return"";let i=0;for(;i<e.length&&92===e.charCodeAt(i);)i++;let a=e.length;for(;a-1>i&&92===e.charCodeAt(a-1);)a--;const n=a-i;let s=0;for(;s<t.length&&92===t.charCodeAt(s);)s++;let l=t.length;for(;l-1>s&&92===t.charCodeAt(l-1);)l--;const h=l-s,c=n<h?n:h;let f=-1,d=0;for(;d<c;d++){const r=e.charCodeAt(i+d);if(r!==t.charCodeAt(s+d))break;92===r&&(f=d)}if(d!==c){if(-1===f)return o}else{if(h>c){if(92===t.charCodeAt(s+d))return o.slice(s+d+1);if(2===d)return o.slice(s+d)}n>c&&(92===e.charCodeAt(i+d)?f=d:2===d&&(f=3)),-1===f&&(f=0)}let p="";for(d=i+f+1;d<=a;++d)d!==a&&92!==e.charCodeAt(d)||(p+=0===p.length?"..":"\\..");return s+=f,p.length>0?`${p}${o.slice(s,l)}`:(92===o.charCodeAt(s)&&++s,o.slice(s,l))},toNamespacedPath(e){if("string"!=typeof e||0===e.length)return e;const t=win32.resolve(e);if(t.length<=2)return e;if(92===t.charCodeAt(0)){if(92===t.charCodeAt(1)){const e=t.charCodeAt(2);if(63!==e&&46!==e)return`\\\\?\\UNC\\${t.slice(2)}`}}else if(isWindowsDeviceRoot(t.charCodeAt(0))&&58===t.charCodeAt(1)&&92===t.charCodeAt(2))return`\\\\?\\${t}`;return e},dirname(e){validateString(e,"path");const t=e.length;if(0===t)return".";let r=-1,o=0;const i=e.charCodeAt(0);if(1===t)return isPathSeparator(i)?e:".";if(isPathSeparator(i)){if(r=o=1,isPathSeparator(e.charCodeAt(1))){let i=2,a=i;for(;i<t&&!isPathSeparator(e.charCodeAt(i));)i++;if(i<t&&i!==a){for(a=i;i<t&&isPathSeparator(e.charCodeAt(i));)i++;if(i<t&&i!==a){for(a=i;i<t&&!isPathSeparator(e.charCodeAt(i));)i++;if(i===t)return e;i!==a&&(r=o=i+1)}}}}else isWindowsDeviceRoot(i)&&58===e.charCodeAt(1)&&(r=t>2&&isPathSeparator(e.charCodeAt(2))?3:2,o=r);let a=-1,n=!0;for(let r=t-1;r>=o;--r)if(isPathSeparator(e.charCodeAt(r))){if(!n){a=r;break}}else n=!1;if(-1===a){if(-1===r)return".";a=r}return e.slice(0,a)},basename(e,t){void 0!==t&&validateString(t,"ext"),validateString(e,"path");let r,o=0,i=-1,a=!0;if(e.length>=2&&isWindowsDeviceRoot(e.charCodeAt(0))&&58===e.charCodeAt(1)&&(o=2),void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let n=t.length-1,s=-1;for(r=e.length-1;r>=o;--r){const l=e.charCodeAt(r);if(isPathSeparator(l)){if(!a){o=r+1;break}}else-1===s&&(a=!1,s=r+1),n>=0&&(l===t.charCodeAt(n)?-1==--n&&(i=r):(n=-1,i=s))}return o===i?i=s:-1===i&&(i=e.length),e.slice(o,i)}for(r=e.length-1;r>=o;--r)if(isPathSeparator(e.charCodeAt(r))){if(!a){o=r+1;break}}else-1===i&&(a=!1,i=r+1);return-1===i?"":e.slice(o,i)},extname(e){validateString(e,"path");let t=0,r=-1,o=0,i=-1,a=!0,n=0;e.length>=2&&58===e.charCodeAt(1)&&isWindowsDeviceRoot(e.charCodeAt(0))&&(t=o=2);for(let s=e.length-1;s>=t;--s){const t=e.charCodeAt(s);if(isPathSeparator(t)){if(!a){o=s+1;break}}else-1===i&&(a=!1,i=s+1),46===t?-1===r?r=s:1!==n&&(n=1):-1!==r&&(n=-1)}return-1===r||-1===i||0===n||1===n&&r===i-1&&r===o+1?"":e.slice(r,i)},format:_format.bind(null,"\\"),parse(e){validateString(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;const r=e.length;let o=0,i=e.charCodeAt(0);if(1===r)return isPathSeparator(i)?(t.root=t.dir=e,t):(t.base=t.name=e,t);if(isPathSeparator(i)){if(o=1,isPathSeparator(e.charCodeAt(1))){let t=2,i=t;for(;t<r&&!isPathSeparator(e.charCodeAt(t));)t++;if(t<r&&t!==i){for(i=t;t<r&&isPathSeparator(e.charCodeAt(t));)t++;if(t<r&&t!==i){for(i=t;t<r&&!isPathSeparator(e.charCodeAt(t));)t++;t===r?o=t:t!==i&&(o=t+1)}}}}else if(isWindowsDeviceRoot(i)&&58===e.charCodeAt(1)){if(r<=2)return t.root=t.dir=e,t;if(o=2,isPathSeparator(e.charCodeAt(2))){if(3===r)return t.root=t.dir=e,t;o=3}}o>0&&(t.root=e.slice(0,o));let a=-1,n=o,s=-1,l=!0,h=e.length-1,c=0;for(;h>=o;--h)if(i=e.charCodeAt(h),isPathSeparator(i)){if(!l){n=h+1;break}}else-1===s&&(l=!1,s=h+1),46===i?-1===a?a=h:1!==c&&(c=1):-1!==a&&(c=-1);return-1!==s&&(-1===a||0===c||1===c&&a===s-1&&a===n+1?t.base=t.name=e.slice(n,s):(t.name=e.slice(n,a),t.base=e.slice(n,s),t.ext=e.slice(a,s))),t.dir=n>0&&n!==o?e.slice(0,n-1):t.root,t},sep:"\\",delimiter:";",win32:null,posix:null};const posixCwd=(()=>{if(platformIsWin32){const e=/\\/g;return()=>{const t=process.cwd().replace(e,"/");return t.slice(t.indexOf("/"))}}return()=>process.cwd()})();export const posix={resolve(...e){let t="",r=!1;for(let o=e.length-1;o>=-1&&!r;o--){const i=o>=0?e[o]:posixCwd();validateString(i,"path"),0!==i.length&&(t=`${i}/${t}`,r=47===i.charCodeAt(0))}return t=normalizeString(t,!r,"/",isPosixPathSeparator),r?`/${t}`:t.length>0?t:"."},normalize(e){if(validateString(e,"path"),0===e.length)return".";const t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return 0===(e=normalizeString(e,!t,"/",isPosixPathSeparator)).length?t?"/":r?"./":".":(r&&(e+="/"),t?`/${e}`:e)},isAbsolute:e=>(validateString(e,"path"),e.length>0&&47===e.charCodeAt(0)),join(...e){if(0===e.length)return".";let t;for(let r=0;r<e.length;++r){const o=e[r];validateString(o,"path"),o.length>0&&(void 0===t?t=o:t+=`/${o}`)}return void 0===t?".":posix.normalize(t)},relative(e,t){if(validateString(e,"from"),validateString(t,"to"),e===t)return"";if((e=posix.resolve(e))===(t=posix.resolve(t)))return"";const r=e.length,o=r-1,i=t.length-1,a=o<i?o:i;let n=-1,s=0;for(;s<a;s++){const r=e.charCodeAt(1+s);if(r!==t.charCodeAt(1+s))break;47===r&&(n=s)}if(s===a)if(i>a){if(47===t.charCodeAt(1+s))return t.slice(1+s+1);if(0===s)return t.slice(1+s)}else o>a&&(47===e.charCodeAt(1+s)?n=s:0===s&&(n=0));let l="";for(s=1+n+1;s<=r;++s)s!==r&&47!==e.charCodeAt(s)||(l+=0===l.length?"..":"/..");return`${l}${t.slice(1+n)}`},toNamespacedPath:e=>e,dirname(e){if(validateString(e,"path"),0===e.length)return".";const t=47===e.charCodeAt(0);let r=-1,o=!0;for(let t=e.length-1;t>=1;--t)if(47===e.charCodeAt(t)){if(!o){r=t;break}}else o=!1;return-1===r?t?"/":".":t&&1===r?"//":e.slice(0,r)},basename(e,t){void 0!==t&&validateString(t,"ext"),validateString(e,"path");let r,o=0,i=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t===e)return"";let n=t.length-1,s=-1;for(r=e.length-1;r>=0;--r){const l=e.charCodeAt(r);if(47===l){if(!a){o=r+1;break}}else-1===s&&(a=!1,s=r+1),n>=0&&(l===t.charCodeAt(n)?-1==--n&&(i=r):(n=-1,i=s))}return o===i?i=s:-1===i&&(i=e.length),e.slice(o,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){o=r+1;break}}else-1===i&&(a=!1,i=r+1);return-1===i?"":e.slice(o,i)},extname(e){validateString(e,"path");let t=-1,r=0,o=-1,i=!0,a=0;for(let n=e.length-1;n>=0;--n){const s=e.charCodeAt(n);if(47!==s)-1===o&&(i=!1,o=n+1),46===s?-1===t?t=n:1!==a&&(a=1):-1!==t&&(a=-1);else if(!i){r=n+1;break}}return-1===t||-1===o||0===a||1===a&&t===o-1&&t===r+1?"":e.slice(t,o)},format:_format.bind(null,"/"),parse(e){validateString(e,"path");const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;const r=47===e.charCodeAt(0);let o;r?(t.root="/",o=1):o=0;let i=-1,a=0,n=-1,s=!0,l=e.length-1,h=0;for(;l>=o;--l){const t=e.charCodeAt(l);if(47!==t)-1===n&&(s=!1,n=l+1),46===t?-1===i?i=l:1!==h&&(h=1):-1!==i&&(h=-1);else if(!s){a=l+1;break}}if(-1!==n){const o=0===a&&r?1:a;-1===i||0===h||1===h&&i===n-1&&i===a+1?t.base=t.name=e.slice(o,n):(t.name=e.slice(o,i),t.base=e.slice(o,n),t.ext=e.slice(i,n))}return a>0?t.dir=e.slice(0,a-1):r&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};posix.win32=win32.win32=win32,posix.posix=win32.posix=posix;export const normalize=platformIsWin32?win32.normalize:posix.normalize;export const resolve=platformIsWin32?win32.resolve:posix.resolve;export const relative=platformIsWin32?win32.relative:posix.relative;export const dirname=platformIsWin32?win32.dirname:posix.dirname;export const basename=platformIsWin32?win32.basename:posix.basename;export const extname=platformIsWin32?win32.extname:posix.extname;export const sep=platformIsWin32?win32.sep:posix.sep;