var __decorate=this&&this.__decorate||function(e,r,t,n){var i,a=arguments.length,s=a<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,t,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(s=(a<3?i(s):a>3?i(r,t,s):i(r,t))||s);return a>3&&s&&Object.defineProperty(r,t,s),s},__param=this&&this.__param||function(e,r){return function(t,n){r(t,n,e)}};import*as dom from"../../../../../base/browser/dom.js";import{CountBadge}from"../../../../../base/browser/ui/countBadge/countBadge.js";import{HighlightedLabel}from"../../../../../base/browser/ui/highlightedlabel/highlightedLabel.js";import{IconLabel}from"../../../../../base/browser/ui/iconLabel/iconLabel.js";import{createMatches,FuzzyScore}from"../../../../../base/common/filters.js";import{Disposable}from"../../../../../base/common/lifecycle.js";import{basename,dirname}from"../../../../../base/common/resources.js";import{ITextModelService}from"../../../../common/services/resolverService.js";import{localize}from"../../../../../nls.js";import{IInstantiationService}from"../../../../../platform/instantiation/common/instantiation.js";import{IKeybindingService}from"../../../../../platform/keybinding/common/keybinding.js";import{ILabelService}from"../../../../../platform/label/common/label.js";import{defaultCountBadgeStyles}from"../../../../../platform/theme/browser/defaultStyles.js";import{FileReferences,OneReference,ReferencesModel}from"../referencesModel.js";let DataSource=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof ReferencesModel||e instanceof FileReferences}getChildren(e){if(e instanceof ReferencesModel)return e.groups;if(e instanceof FileReferences)return e.resolve(this._resolverService).then((e=>e.children));throw new Error("bad tree")}};DataSource=__decorate([__param(0,ITextModelService)],DataSource);export{DataSource};export class Delegate{getHeight(){return 23}getTemplateId(e){return e instanceof FileReferences?FileReferencesRenderer.id:OneReferenceRenderer.id}}let StringRepresentationProvider=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){var r;if(e instanceof OneReference){const t=null===(r=e.parent.getPreview(e))||void 0===r?void 0:r.preview(e.range);if(t)return t.value}return basename(e.uri)}};StringRepresentationProvider=__decorate([__param(0,IKeybindingService)],StringRepresentationProvider);export{StringRepresentationProvider};export class IdentityProvider{getId(e){return e instanceof OneReference?e.id:e.uri}}let FileReferencesTemplate=class extends Disposable{constructor(e,r){super(),this._labelService=r;const t=document.createElement("div");t.classList.add("reference-file"),this.file=this._register(new IconLabel(t,{supportHighlights:!0})),this.badge=new CountBadge(dom.append(t,dom.$(".count")),{},defaultCountBadgeStyles),e.appendChild(t)}set(e,r){const t=dirname(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(t,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:r});const n=e.children.length;this.badge.setCount(n),n>1?this.badge.setTitleFormat(localize("referencesCount","{0} references",n)):this.badge.setTitleFormat(localize("referenceCount","{0} reference",n))}};FileReferencesTemplate=__decorate([__param(1,ILabelService)],FileReferencesTemplate);let FileReferencesRenderer=class e{constructor(r){this._instantiationService=r,this.templateId=e.id}renderTemplate(e){return this._instantiationService.createInstance(FileReferencesTemplate,e)}renderElement(e,r,t){t.set(e.element,createMatches(e.filterData))}disposeTemplate(e){e.dispose()}};FileReferencesRenderer.id="FileReferencesRenderer",FileReferencesRenderer=__decorate([__param(0,IInstantiationService)],FileReferencesRenderer);export{FileReferencesRenderer};class OneReferenceTemplate{constructor(e){this.label=new HighlightedLabel(e)}set(e,r){var t;const n=null===(t=e.parent.getPreview(e))||void 0===t?void 0:t.preview(e.range);if(n&&n.value){const{value:e,highlight:t}=n;r&&!FuzzyScore.isDefault(r)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(e,createMatches(r))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(e,[t]))}else this.label.set(`${basename(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`)}}class OneReferenceRenderer{constructor(){this.templateId=OneReferenceRenderer.id}renderTemplate(e){return new OneReferenceTemplate(e)}renderElement(e,r,t){t.set(e.element,e.filterData)}disposeTemplate(){}}OneReferenceRenderer.id="OneReferenceRenderer";export{OneReferenceRenderer};export class AccessibilityProvider{getWidgetAriaLabel(){return localize("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}