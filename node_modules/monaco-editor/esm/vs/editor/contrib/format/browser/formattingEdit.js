import{EditOperation}from"../../../common/core/editOperation.js";import{Range}from"../../../common/core/range.js";import{StableEditorScrollState}from"../../../browser/stableEditorScroll.js";export class FormattingEdit{static _handleEolEdits(t,e){let o;const r=[];for(const t of e)"number"==typeof t.eol&&(o=t.eol),t.range&&"string"==typeof t.text&&r.push(t);return"number"==typeof o&&t.hasModel()&&t.getModel().pushEOL(o),r}static _isFullModelReplaceEdit(t,e){if(!t.hasModel())return!1;const o=t.getModel(),r=o.validateRange(e.range);return o.getFullModelRange().equalsRange(r)}static execute(t,e,o){o&&t.pushUndoStop();const r=StableEditorScrollState.capture(t),a=FormattingEdit._handleEolEdits(t,e);1===a.length&&FormattingEdit._isFullModelReplaceEdit(t,a[0])?t.executeEdits("formatEditsCommand",a.map((t=>EditOperation.replace(Range.lift(t.range),t.text)))):t.executeEdits("formatEditsCommand",a.map((t=>EditOperation.replaceMove(Range.lift(t.range),t.text)))),o&&t.pushUndoStop(),r.restoreRelativeVerticalPositionOfCursor(t)}}