import{DisposableStore}from"../../../../base/common/lifecycle.js";class OvertypingCapturer{constructor(e,t){this._disposables=new DisposableStore,this._lastOvertyped=[],this._locked=!1,this._disposables.add(e.onWillType((()=>{if(this._locked||!e.hasModel())return;const t=e.getSelections(),s=t.length;let i=!1;for(let e=0;e<s;e++)if(!t[e].isEmpty()){i=!0;break}if(!i)return void(0!==this._lastOvertyped.length&&(this._lastOvertyped.length=0));this._lastOvertyped=[];const r=e.getModel();for(let e=0;e<s;e++){const s=t[e];if(r.getValueLengthInRange(s)>OvertypingCapturer._maxSelectionLength)return;this._lastOvertyped[e]={value:r.getValueInRange(s),multiline:s.startLineNumber!==s.endLineNumber}}}))),this._disposables.add(t.onDidTrigger((e=>{this._locked=!0}))),this._disposables.add(t.onDidCancel((e=>{this._locked=!1})))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}}OvertypingCapturer._maxSelectionLength=51200;export{OvertypingCapturer};