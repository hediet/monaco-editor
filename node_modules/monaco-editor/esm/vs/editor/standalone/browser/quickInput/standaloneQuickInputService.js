var __decorate=this&&this.__decorate||function(t,e,i,o){var r,c=arguments.length,n=c<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(n=(c<3?r(n):c>3?r(e,i,n):r(e,i))||n);return c>3&&n&&Object.defineProperty(e,i,n),n},__param=this&&this.__param||function(t,e){return function(i,o){e(i,o,t)}};import"./standaloneQuickInput.css";import{registerEditorContribution}from"../../../browser/editorExtensions.js";import{IThemeService}from"../../../../platform/theme/common/themeService.js";import{CancellationToken}from"../../../../base/common/cancellation.js";import{IInstantiationService}from"../../../../platform/instantiation/common/instantiation.js";import{IContextKeyService}from"../../../../platform/contextkey/common/contextkey.js";import{IAccessibilityService}from"../../../../platform/accessibility/common/accessibility.js";import{EditorScopedLayoutService}from"../standaloneLayoutService.js";import{ICodeEditorService}from"../../../browser/services/codeEditorService.js";import{QuickInputService}from"../../../../platform/quickinput/browser/quickInput.js";import{once}from"../../../../base/common/functional.js";let EditorScopedQuickInputService=class extends QuickInputService{constructor(t,e,i,o,r,c){super(e,i,o,r,new EditorScopedLayoutService(t.getContainerDomNode(),c)),this.host=void 0;const n=QuickInputEditorContribution.get(t);if(n){const e=n.widget;this.host={_serviceBrand:void 0,get hasContainer(){return!0},get container(){return e.getDomNode()},get dimension(){return t.getLayoutInfo()},get onDidLayout(){return t.onDidLayoutChange},focus:()=>t.focus(),offset:{top:0,quickPickTop:0}}}else this.host=void 0}createController(){return super.createController(this.host)}};EditorScopedQuickInputService=__decorate([__param(1,IInstantiationService),__param(2,IContextKeyService),__param(3,IThemeService),__param(4,IAccessibilityService),__param(5,ICodeEditorService)],EditorScopedQuickInputService);let StandaloneQuickInputService=class{get activeService(){const t=this.codeEditorService.getFocusedCodeEditor();if(!t)throw new Error("Quick input service needs a focused editor to work.");let e=this.mapEditorToService.get(t);if(!e){const i=e=this.instantiationService.createInstance(EditorScopedQuickInputService,t);this.mapEditorToService.set(t,e),once(t.onDidDispose)((()=>{i.dispose(),this.mapEditorToService.delete(t)}))}return e}get quickAccess(){return this.activeService.quickAccess}constructor(t,e){this.instantiationService=t,this.codeEditorService=e,this.mapEditorToService=new Map}pick(t,e={},i=CancellationToken.None){return this.activeService.pick(t,e,i)}createQuickPick(){return this.activeService.createQuickPick()}createInputBox(){return this.activeService.createInputBox()}};StandaloneQuickInputService=__decorate([__param(0,IInstantiationService),__param(1,ICodeEditorService)],StandaloneQuickInputService);export{StandaloneQuickInputService};class QuickInputEditorContribution{static get(t){return t.getContribution(QuickInputEditorContribution.ID)}constructor(t){this.editor=t,this.widget=new QuickInputEditorWidget(this.editor)}dispose(){this.widget.dispose()}}QuickInputEditorContribution.ID="editor.controller.quickInput";export{QuickInputEditorContribution};class QuickInputEditorWidget{constructor(t){this.codeEditor=t,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return QuickInputEditorWidget.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}}QuickInputEditorWidget.ID="editor.contrib.quickInputWidget";export{QuickInputEditorWidget};registerEditorContribution(QuickInputEditorContribution.ID,QuickInputEditorContribution,4);