import{Schemas}from"../../../base/common/network.js";import{DataUri}from"../../../base/common/resources.js";import{PLAINTEXT_LANGUAGE_ID}from"../languages/modesRegistry.js";import{FileKind}from"../../../platform/files/common/files.js";const fileIconDirectoryRegex=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;export function getIconClasses(e,s,t,a){const i=a===FileKind.ROOT_FOLDER?["rootfolder-icon"]:a===FileKind.FOLDER?["folder-icon"]:["file-icon"];if(t){let o;if(t.scheme===Schemas.data)o=DataUri.parseMetaData(t).get(DataUri.META_DATA_LABEL);else{const e=t.path.match(fileIconDirectoryRegex);e?(o=cssEscape(e[2].toLowerCase()),e[1]&&i.push(`${cssEscape(e[1].toLowerCase())}-name-dir-icon`)):o=cssEscape(t.authority.toLowerCase())}if(a===FileKind.FOLDER)i.push(`${o}-name-folder-icon`);else{if(o){if(i.push(`${o}-name-file-icon`),i.push("name-file-icon"),o.length<=255){const e=o.split(".");for(let s=1;s<e.length;s++)i.push(`${e.slice(s).join(".")}-ext-file-icon`)}i.push("ext-file-icon")}const a=detectLanguageId(e,s,t);a&&i.push(`${cssEscape(a)}-lang-file-icon`)}}return i}function detectLanguageId(e,s,t){if(!t)return null;let a=null;if(t.scheme===Schemas.data){const e=DataUri.parseMetaData(t).get(DataUri.META_DATA_MIME);e&&(a=s.getLanguageIdByMimeType(e))}else{const s=e.getModel(t);s&&(a=s.getLanguageId())}return a&&a!==PLAINTEXT_LANGUAGE_ID?a:s.guessLanguageIdByFilepathOrFirstLine(t)}function cssEscape(e){return e.replace(/[\11\12\14\15\40]/g,"/")}