import{IndentAction}from"./languageConfiguration.js";import{getIndentationAtPosition,getScopedLineTokens}from"./languageConfigurationRegistry.js";export function getEnterAction(t,n,e,o){const i=getScopedLineTokens(n,e.startLineNumber,e.startColumn),r=o.getLanguageConfiguration(i.languageId);if(!r)return null;const s=i.getLineContent(),a=s.substr(0,e.startColumn-1-i.firstCharOffset);let u;u=e.isEmpty()?s.substr(e.startColumn-1-i.firstCharOffset):getScopedLineTokens(n,e.endLineNumber,e.endColumn).getLineContent().substr(e.endColumn-1-i.firstCharOffset);let g="";if(e.startLineNumber>1&&0===i.firstCharOffset){const t=getScopedLineTokens(n,e.startLineNumber-1);t.languageId===i.languageId&&(g=t.getLineContent())}const d=r.onEnter(t,g,a,u);if(!d)return null;const f=d.indentAction;let l=d.appendText;const c=d.removeText||0;l?f===IndentAction.Indent&&(l="\t"+l):l=f===IndentAction.Indent||f===IndentAction.IndentOutdent?"\t":"";let m=getIndentationAtPosition(n,e.startLineNumber,e.startColumn);return c&&(m=m.substring(0,m.length-c)),{indentAction:f,appendText:l,removeText:c,indentation:m}}