import*as platform from"../../../base/common/platform.js";import{EditorFontVariations,EDITOR_FONT_DEFAULTS}from"./editorOptions.js";import{EditorZoom}from"./editorZoom.js";const GOLDEN_LINE_HEIGHT_RATIO=platform.isMacintosh?1.5:1.35,MINIMUM_LINE_HEIGHT=8;export class BareFontInfo{static createFromValidatedSettings(t,i,e){const o=t.get(46),a=t.get(50),n=t.get(49),s=t.get(48),r=t.get(51),h=t.get(63),d=t.get(60);return BareFontInfo._create(o,a,n,s,r,h,d,i,e)}static _create(t,i,e,o,a,n,s,r,h){0===n?n=GOLDEN_LINE_HEIGHT_RATIO*e:n<8&&(n*=e),(n=Math.round(n))<8&&(n=8);const d=1+(h?0:.1*EditorZoom.getZoomLevel());return e*=d,n*=d,a===EditorFontVariations.TRANSLATE&&("normal"===i||"bold"===i?a=EditorFontVariations.OFF:(a=`'wght' ${parseInt(i,10)}`,i="normal")),new BareFontInfo({pixelRatio:r,fontFamily:t,fontWeight:i,fontSize:e,fontFeatureSettings:o,fontVariationSettings:a,lineHeight:n,letterSpacing:s})}constructor(t){this._bareFontInfoBrand=void 0,this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.fontVariationSettings=t.fontVariationSettings,this.lineHeight=0|t.lineHeight,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const t=EDITOR_FONT_DEFAULTS.fontFamily,i=BareFontInfo._wrapInQuotes(this.fontFamily);return t&&this.fontFamily!==t?`${i}, ${t}`:i}static _wrapInQuotes(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}}export const SERIALIZED_FONT_INFO_VERSION=2;export class FontInfo extends BareFontInfo{constructor(t,i){super(t),this._editorStylingBrand=void 0,this.version=2,this.isTrusted=i,this.isMonospace=t.isMonospace,this.typicalHalfwidthCharacterWidth=t.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=t.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=t.canUseHalfwidthRightwardsArrow,this.spaceWidth=t.spaceWidth,this.middotWidth=t.middotWidth,this.wsmiddotWidth=t.wsmiddotWidth,this.maxDigitWidth=t.maxDigitWidth}equals(t){return this.fontFamily===t.fontFamily&&this.fontWeight===t.fontWeight&&this.fontSize===t.fontSize&&this.fontFeatureSettings===t.fontFeatureSettings&&this.fontVariationSettings===t.fontVariationSettings&&this.lineHeight===t.lineHeight&&this.letterSpacing===t.letterSpacing&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===t.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.maxDigitWidth===t.maxDigitWidth}}