import"./linesDecorations.css";import{DecorationToRender,DedupOverlay}from"../glyphMargin/glyphMargin.js";export class LinesDecorationsOverlay extends DedupOverlay{constructor(e){super(),this._context=e;const t=this._context.configuration.options.get(138);this._decorationsLeft=t.decorationsLeft,this._decorationsWidth=t.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options.get(138);return this._decorationsLeft=t.decorationsLeft,this._decorationsWidth=t.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),n=[];let r=0;for(let e=0,o=t.length;e<o;e++){const o=t[e],s=o.options.linesDecorationsClassName;s&&(n[r++]=new DecorationToRender(o.range.startLineNumber,o.range.endLineNumber,s));const i=o.options.firstLineDecorationClassName;i&&(n[r++]=new DecorationToRender(o.range.startLineNumber,o.range.startLineNumber,i))}return n}prepareRender(e){const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,r=this._render(t,n,this._getDecorations(e)),o='" style="left:'+this._decorationsLeft.toString()+"px;width:"+this._decorationsWidth.toString()+'px;"></div>',s=[];for(let e=t;e<=n;e++){const n=e-t,i=r[n];let a="";for(let e=0,t=i.length;e<t;e++)a+='<div class="cldr '+i[e]+o;s[n]=a}this._renderResult=s}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}