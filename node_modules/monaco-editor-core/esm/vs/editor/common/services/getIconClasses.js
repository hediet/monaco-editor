import{Schemas}from"../../../base/common/network.js";import{DataUri}from"../../../base/common/resources.js";import{PLAINTEXT_LANGUAGE_ID}from"../languages/modesRegistry.js";import{FileKind}from"../../../platform/files/common/files.js";const fileIconDirectoryRegex=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;export function getIconClasses(e,t,s,o){const a=o===FileKind.ROOT_FOLDER?["rootfolder-icon"]:o===FileKind.FOLDER?["folder-icon"]:["file-icon"];if(s){let i;if(s.scheme===Schemas.data)i=DataUri.parseMetaData(s).get(DataUri.META_DATA_LABEL);else{const e=s.path.match(fileIconDirectoryRegex);e?(i=cssEscape(e[2].toLowerCase()),e[1]&&a.push(`${cssEscape(e[1].toLowerCase())}-name-dir-icon`)):i=cssEscape(s.authority.toLowerCase())}if(o===FileKind.FOLDER)a.push(`${i}-name-folder-icon`);else{if(i){if(a.push(`${i}-name-file-icon`),a.push("name-file-icon"),i.length<=255){const e=i.split(".");for(let t=1;t<e.length;t++)a.push(`${e.slice(t).join(".")}-ext-file-icon`)}a.push("ext-file-icon")}const o=detectLanguageId(e,t,s);o&&a.push(`${cssEscape(o)}-lang-file-icon`)}}return a}function detectLanguageId(e,t,s){if(!s)return null;let o=null;if(s.scheme===Schemas.data){const e=DataUri.parseMetaData(s).get(DataUri.META_DATA_MIME);e&&(o=t.getLanguageIdByMimeType(e))}else{const t=e.getModel(s);t&&(o=t.getLanguageId())}return o&&o!==PLAINTEXT_LANGUAGE_ID?o:t.guessLanguageIdByFilepathOrFirstLine(s)}export function cssEscape(e){return e.replace(/[\11\12\14\15\40]/g,"/")}