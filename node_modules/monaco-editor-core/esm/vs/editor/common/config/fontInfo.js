import*as platform from"../../../base/common/platform.js";import{EDITOR_FONT_DEFAULTS}from"./editorOptions.js";import{EditorZoom}from"./editorZoom.js";const GOLDEN_LINE_HEIGHT_RATIO=platform.isMacintosh?1.5:1.35,MINIMUM_LINE_HEIGHT=8;export class BareFontInfo{static createFromValidatedSettings(t,i,e){const o=t.get(44),a=t.get(48),h=t.get(47),s=t.get(46),n=t.get(60),r=t.get(57);return BareFontInfo._create(o,a,h,s,n,r,i,e)}static _create(t,i,e,o,a,h,s,n){0===a?a=GOLDEN_LINE_HEIGHT_RATIO*e:a<8&&(a*=e),(a=Math.round(a))<8&&(a=8);const r=1+(n?0:.1*EditorZoom.getZoomLevel());return new BareFontInfo({pixelRatio:s,fontFamily:t,fontWeight:i,fontSize:e*=r,fontFeatureSettings:o,lineHeight:a*=r,letterSpacing:h})}constructor(t){this._bareFontInfoBrand=void 0,this.pixelRatio=t.pixelRatio,this.fontFamily=String(t.fontFamily),this.fontWeight=String(t.fontWeight),this.fontSize=t.fontSize,this.fontFeatureSettings=t.fontFeatureSettings,this.lineHeight=0|t.lineHeight,this.letterSpacing=t.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const t=EDITOR_FONT_DEFAULTS.fontFamily,i=BareFontInfo._wrapInQuotes(this.fontFamily);return t&&this.fontFamily!==t?`${i}, ${t}`:i}static _wrapInQuotes(t){return/[,"']/.test(t)?t:/[+ ]/.test(t)?`"${t}"`:t}}export const SERIALIZED_FONT_INFO_VERSION=1;export class FontInfo extends BareFontInfo{constructor(t,i){super(t),this._editorStylingBrand=void 0,this.version=1,this.isTrusted=i,this.isMonospace=t.isMonospace,this.typicalHalfwidthCharacterWidth=t.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=t.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=t.canUseHalfwidthRightwardsArrow,this.spaceWidth=t.spaceWidth,this.middotWidth=t.middotWidth,this.wsmiddotWidth=t.wsmiddotWidth,this.maxDigitWidth=t.maxDigitWidth}equals(t){return this.fontFamily===t.fontFamily&&this.fontWeight===t.fontWeight&&this.fontSize===t.fontSize&&this.fontFeatureSettings===t.fontFeatureSettings&&this.lineHeight===t.lineHeight&&this.letterSpacing===t.letterSpacing&&this.typicalHalfwidthCharacterWidth===t.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===t.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===t.canUseHalfwidthRightwardsArrow&&this.spaceWidth===t.spaceWidth&&this.middotWidth===t.middotWidth&&this.wsmiddotWidth===t.wsmiddotWidth&&this.maxDigitWidth===t.maxDigitWidth}}